<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
	
	<!-- Define main product -->
	
	<?define UpgradeCode = 28bebc9f-1f55-46fa-a203-48b3c3a90894?>

  <!-- Change Product Id in every release to allow upgrades of previous installations -->
	<Product Id="{04454F73-1D90-4431-A153-A95462E577BE}" 
			 Name="!(loc.ProductName)" 
			 Language="!(loc.Language)"
			 Version="$(var.BuildVersion)"
			 Manufacturer="!(loc.Company)"
			 UpgradeCode="$(var.UpgradeCode)">
		
		<!-- Package details -->
		<Package InstallerVersion="200"
				 Comments="!(loc.Copyright)"
				 Compressed="yes"
				 Description="!(loc.Description)"
				 InstallScope="perMachine" />
	
		<!-- Downgrade error message -->
		<MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />

		<SetProperty Id="URL" Value="!(loc.Web)" Sequence="execute" Before="CreateShortcuts" />

		<!-- Include .cab file into .msi file -->
		<MediaTemplate EmbedCab="yes"/>

		<!-- Use an icon for the installer -->
		<Icon Id="Icon.ico" SourceFile="$(var.BIMiconToolbar.ProjectDir)\Resources\Logos\iconBIMiconBlack.ico"/>
		<Property Id="ARPPRODUCTICON">Icon.ico</Property>
		<Property Id="ARPURLINFOABOUT">htpps://www.BIMicon.com</Property>
		
		<!-- Create UI for installer -->
		<UIRef Id="WixUI_Minimal"/>
		<WixVariable Id="WixUIDialogBmp" Value="$(var.ProjectDir)\Assets\Background.png"/>
		<WixVariable Id="WixUIBannerBmp" Value="$(var.ProjectDir)\Assets\Banner.png"/>
		<WixVariable Id="WixUILicenseRtf" Value="$(var.ProjectDir)\Assets\License.rtf"/>
		
		<!-- Define components, shortcuts, etc for installer-->
		<!-- Start menu shortcuts -->
		<Feature Id="StartMenu" Level="1">
			<ComponentRef Id="StartMenu"/>
		</Feature>
    <!-- Main components: dlls -->
    <Feature Id="MainDlls" Title="!(loc.ProductName) Assemblies" Level="1">
      <ComponentRef Id="WarningsFile"/>
      <ComponentGroupRef Id="ProductComponents" />
      <Condition Level="0">
        <![CDATA[ DLLSDIRECTORY = null]]>
      </Condition>
    </Feature>
		<!-- Revit 2017 -->
		<Feature Id="Toolbar2017" Title="!(loc.ProductName) 2017" Level="1">
			<ComponentRef Id="AddinFile2017"/>
			<Condition Level="0">
				<![CDATA[ ADDIN2017DIRECTORY = null]]>
			</Condition>
		</Feature>
		<!-- Revit 2018 -->
		<Feature Id="Toolbar2018" Title="!(loc.ProductName) 2018" Level="1">
			<ComponentRef Id="AddinFile2018"/>
			<Condition Level="0">
				<![CDATA[ ADDIN2018DIRECTORY = null]]>
			</Condition>
		</Feature>
		<!-- Revit 2019 -->
		<Feature Id="Toolbar2019" Title="!(loc.ProductName) 2019" Level="1">
			<ComponentRef Id="AddinFile2019"/>
			<Condition Level="0">
				<![CDATA[ ADDIN2019DIRECTORY = null]]>
			</Condition>
		</Feature>
		<!-- Revit 2020 -->
		<Feature Id="Toolbar2020" Title="!(loc.ProductName) 2020" Level="1">
			<ComponentRef Id="AddinFile2020"/>
			<Condition Level="0">
				<![CDATA[ ADDIN2020DIRECTORY = null]]>
			</Condition>
		</Feature>
		<!-- Revit 2021 -->
		<Feature Id="Toolbar2021" Title="!(loc.ProductName) 2021" Level="1">
			<ComponentRef Id="AddinFile2021"/>
			<Condition Level="0">
				<![CDATA[ ADDIN2021DIRECTORY = null]]>
			</Condition>
		</Feature>
    <!-- Revit 2022 -->
    <Feature Id="Toolbar2022" Title="!(loc.ProductName) 2022" Level="1">
      <ComponentRef Id="AddinFile2022"/>
      <Condition Level="0">
        <![CDATA[ ADDIN2022DIRECTORY = null]]>
      </Condition>
    </Feature>
		
	</Product>

</Wix>
